# План запуску Arma Reforger Dedicated Server (LinuxGSM)

Цей документ можна розділити на 2 файли в репозиторії:

* `docs/PLAN.md` — план з чеклістами
* `docs/MODDING.md` — окрема інструкція: як робити моди (Workbench) + офіційні посилання

Посилання на базову адмін-інструкцію (Discord): `docs/arma-reforger-linuxgsm-discord.md`

---

## ФАЙЛ: docs/PLAN.md

## 1) Хостинг (хоста ще немає) — вибір і підготовка

### 1.1 Вибір типу хостингу

* [ ] Визначити формат: **VPS/Dedicated** (самостійна адмінка) або **Game Server Hosting** (панель, менше контролю)
* [ ] Оцінити навантаження: кількість гравців, чи буде багато модів/скриптів/сценаріїв
* [ ] Вибрати регіон (EU) і DC ближче до аудиторії

### 1.2 Мінімальні вимоги (практично)

* [ ] CPU: 4 vCPU (краще 6–8 для модів/великого онлайна)
* [ ] RAM: 8–16 GB (чим більше модів — тим більше RAM)
* [ ] Disk: 40+ GB (гра + кеш модів + логи + бекапи)
* [ ] Network: стабільний uplink, низький jitter, публічна IP (або коректний NAT/port-forward)

### 1.3 Базова підготовка сервера

* [ ] OS: Ubuntu 20.04/22.04 або Debian 11/12 (64-bit)
* [ ] Оновити систему: `apt update && apt upgrade -y`
* [ ] Налаштувати SSH ключі, заборонити root-login, закрити парольну авторизацію (рекомендовано)
* [ ] Налаштувати firewall (UFW/iptables) і відкрити потрібні порти (див. нижче)
* [ ] Увімкнути час/таймзону (для логів), налаштувати `fail2ban` (за бажання)

---

## 2) Розгортання (LinuxGSM) — за базовою інструкцією

### 2.1 Інсталяція LinuxGSM

* [ ] Створити користувача: `adduser armarserver`
* [ ] Поставити LinuxGSM скрипт `armarserver`
* [ ] Виконати: `./armarserver install`

### 2.2 Верифікація після інсталяції

* [ ] Запустити: `./armarserver start`
* [ ] Перевірити: `./armarserver details` (шляхи, порти, конфіги)
* [ ] Перевірити: `./armarserver monitor`
* [ ] Увімкнути авто-моніторинг/оновлення через cron (мінімум)

Посилання: див. `docs/arma-reforger-linuxgsm-discord.md`

---

## 3) Мережа і порти — чекліст

> ВАЖЛИВО: **джерело істини** — `./armarserver details` + ваш `server.json`.

* [ ] Визначити **Game Port** (часто `2001/UDP`)
* [ ] Якщо є A2S/Query/Steam query — відкрити відповідні порти (залежить від конфігу/хостингу)
* [ ] Якщо використовуєте BattlEye / RCon — відкрити порт, якщо він заданий
* [ ] Якщо сервер за NAT — зробити **port forwarding** на реальний IP сервера
* [ ] Перевірити доступність портів зовні (nmap/онлайн port checker)

---

## 4) Конфіг сервера (server.json) — чекліст “база”

* [ ] Знайти реальний шлях до `server.json` через `./armarserver details`
* [ ] Заповнити мінімально необхідне:

  * [ ] `game.name`
  * [ ] `adminPassword`
  * [ ] `game.playerCountLimit`
  * [ ] `region`
  * [ ] `gameHostBindAddress` / `gameHostBindPort` (або еквівалент у вашій схемі)
  * [ ] `visible` / `password` (якщо потрібно приватно)
* [ ] Перезапуск після змін: `./armarserver restart`
* [ ] Після кожної правки перевірити JSON (жодних зайвих ком), інакше буде “JSON parse error”

---

## 5) Сценарій: вибір + створення (деталізовано)

### 5.1 Вибір сценарію (стандартний / офіційний)

* [ ] Вирішити режим:

  * [ ] **Conflict** (війна за точки, кампанія)
  * [ ] **Game Master** (GM)
  * [ ] **Combat Ops** / **Capture & Hold** (якщо потрібно)
* [ ] Вказати `scenarioId` у `server.json`
* [ ] Перезапустити сервер

Порада:

* Якщо не впевнені у доступних сценаріях на вашій версії — скористайтесь параметром запуску **`-listScenarios`** (див. офіційні Startup Parameters) і звірте шлях `.conf`.

### 5.2 Чекліст “перемикання сценарію без сюрпризів”

* [ ] Перед зміною зробити `./armarserver backup`
* [ ] Змінити лише `scenarioId`
* [ ] `./armarserver restart`
* [ ] Перевірити логи на помилки завантаження сценарію (часто: неправильний шлях `.conf` або відсутній мод)

### 5.3 Створення власного сценарію (кастом) — як це робиться на практиці

**Ключова ідея:** кастомний сценарій у Reforger зазвичай живе як **мод/пакет** (Workbench проект), який містить `Missions/*.conf`, префаби, ресурси, скрипти. Далі ви публікуєте мод у Workshop і підключаєте його на сервері через `mods[]`, а `scenarioId` посилається на `.conf` усередині мода.

#### A) Підготовка інструментів

* [ ] Встановити **Arma Reforger Tools / Workbench** зі Steam (Tools)
* [ ] Встановити/оновити гру Arma Reforger (для тесту локально)

#### B) Підхід 1: “швидкий” кастом для GM (на базі Eden)

* [ ] Створити новий Workbench проект (Mod Project)
* [ ] Відкрити World Editor
* [ ] Використати **Scenario Framework** (див. офіційні сторінки) для складання сценарію без складного скриптингу
* [ ] Додати точки спавну, ролі, базові правила, потрібні префаби
* [ ] Зберегти місію як `.conf` у `Missions/`
* [ ] Протестувати локально (Workbench/гра)

#### C) Підхід 2: “повноцінний” сценарій (Task System / логіка / скрипт)

* [ ] Визначити структуру місії: цілі, тригери, умови перемоги
* [ ] Використовувати Scenario Framework + (за потреби) Task System / скрипти
* [ ] Додати логіку для старту/рестарту, сейвів, спавнів
* [ ] Прогнати тест: локально, потім на тестовому сервері

#### D) Публікація і підключення на сервер

* [ ] Зібрати (bundle) мод
* [ ] Опублікувати у Workshop (Publish Project)
* [ ] Додати мод у `mods: []` у `server.json` (modId/name/version)
* [ ] Вказати `scenarioId` на `.conf` вашого сценарію (з GUID/шляхом), як це показано на сторінці сценарію у Workshop
* [ ] `./armarserver restart`

**Готовність:** сценарій вважається “готовим”, коли:

* [ ] сервер стартує без помилок завантаження модів/сценарію
* [ ] клієнт може зайти і автоматично докачує моди
* [ ] сценарій коректно стартує (спавни/правила/цілі)

---

## 6) Додавання модів — чекліст

### 6.1 Збір списку модів

* [ ] Скласти список модів (Workshop)
* [ ] Перевірити залежності (prerequisites)
* [ ] Для кожного мода записати:

  * [ ] `modId`
  * [ ] `name`
  * [ ] `version` (або залишати порожнім, якщо ваш підхід — завжди latest)

Практичні способи отримати JSON мод-лист:

* [ ] У грі (Workshop) — “пазл/мод-пак” → вкладка **JSON** → Copy (якщо доступно у вашій версії UI)
* [ ] Через workshop web-портал Arma Platform — мод має видимі `modId` і `version`

### 6.2 Внесення у server.json

* [ ] Відкрити `server.json`
* [ ] Знайти блок `"mods": []`
* [ ] Додати елементи виду:

  * `{ "modId": "XXXXXXXXXXXXXXX", "name": "Some Mod", "version": "1.2.3" }`
* [ ] Перевірити JSON (коми між елементами; без коми після останнього)
* [ ] `./armarserver restart`

### 6.3 Валідація після додавання модів

* [ ] Сервер стартує без “missing mod / cannot load”
* [ ] Клієнт докачує моди при підключенні
* [ ] Немає “mod mismatch” (версії/залежності)
* [ ] Логи чисті від повторюваних помилок

---

## 7) Нюанси (типові граблі) — чекліст

* [ ] **JSON синтаксис**: одна зайва кома = сервер не стартує
* [ ] **mods + scenarioId**: якщо сценарій з Workshop — спочатку додайте мод у `mods[]`, і лише тоді ставте `scenarioId` з цього мода
* [ ] **Оновлення модів**: версії можуть змінюватись; після update перевіряйте вхід клієнтів
* [ ] **SteamCMD логін**: краще окремий Steam-акаунт для сервера
* [ ] **Бекапи**: перед апдейтом/великими правками — `./armarserver backup`
* [ ] **Моніторинг**: `./armarserver monitor` у cron
* [ ] **Тестовий стенд**: перед продом — окремий тестовий сервер або хоча б окремий конфіг

---

## 8) Операційні процедури (SOP)

### 8.1 Регламент змін

* [ ] Будь-яка зміна (mods/scenario/config) → бекап → зміна → рестарт → перевірка логів → тест підключення

### 8.2 Регламент оновлень

* [ ] Регулярно: `./armarserver update`
* [ ] При проблемах: `./armarserver validate`
* [ ] Раз на тиждень/місяць: `./armarserver update-lgsm`

### 8.3 Швидка діагностика

* [ ] `./armarserver details`
* [ ] `./armarserver debug`
* [ ] Перегляд логів `/home/armarserver/logs`

---
